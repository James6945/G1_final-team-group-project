<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Child Account</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #4f46e5;
      --primary-light: #6366f1;
      --primary-dark: #4338ca;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --dark: #1f2937;
      --light: #f9fafb;
      --gray: #9ca3af;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
      color: var(--dark);
      line-height: 1.6;
      min-height: 100vh;
      display: flex; justify-content: center; align-items: center;
      padding: 20px; font-size: 18px;
    }
    .container {
      width: 100%; max-width: 2050px; height: 1110px;
      background: white; border-radius: 20px;
      box-shadow: 0 15px 30px -5px rgba(0,0,0,.15); overflow: hidden;
    }
    header { background: var(--primary); color: white; padding: 32px 40px; text-align: center; }
    h1 { font-size: 36px; font-weight: 600; margin-bottom: 12px; }
    .subtitle { font-size: 20px; opacity: .9; }
    .wallet-info { display: flex; justify-content: center; gap: 30px; margin-top: 20px; flex-wrap: wrap; }
    .status { display: flex; align-items: center; gap: 10px; background: rgba(255,255,255,.15); padding: 12px 20px; border-radius: 25px; font-size: 18px; }
    .status-dot { width: 12px; height: 12px; border-radius: 50%; background: var(--gray); }
    .status-dot.connected { background: var(--success); }
    #btnConnect { background: white; color: var(--primary); border: none; padding: 14px 28px; border-radius: 10px; font-weight: 600; cursor: pointer; transition: .2s; display: flex; align-items: center; gap: 10px; font-size: 18px; }
    #btnConnect:hover { background: #f3f4f6; transform: translateY(-2px); }
    .main-content { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0; }
    @media (max-width: 1000px) { .main-content { grid-template-columns: 1fr; } }
    .card { padding: 40px; border-right: 1px solid #e5e7eb; display: flex; flex-direction: column; height: 100%; }
    .card:last-child { border-right: none; }
    .card-title { display: flex; align-items: center; gap: 16px; margin-bottom: 30px; font-size: 24px; font-weight: 600; color: var(--primary); }
    .card-title i { font-size: 28px; background: var(--primary-light); color: white; width: 60px; height: 60px; display: flex; align-items: center; justify-content: center; border-radius: 15px; }
    .form-group { margin-bottom: 25px; }
    label { display: block; margin-bottom: 12px; font-weight: 500; font-size: 18px; color: var(--dark); }
    input { width: 100%; padding: 18px 20px; border: 1px solid #d1d5db; border-radius: 10px; font-size: 18px; transition: border .2s; }
    input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 4px rgba(79,70,229,.2); }
    button.action { background: var(--primary); color: white; border: none; padding: 18px 28px; border-radius: 10px; font-weight: 600; cursor: pointer; transition: .2s; display: flex; align-items: center; gap: 10px; width: 100%; justify-content: center; margin-top: 12px; font-size: 18px; }
    button.action:hover { background: var(--primary-dark); transform: translateY(-2px); }
    .feedback { padding: 16px 20px; border-radius: 10px; margin-top: 20px; display: none; align-items: center; gap: 14px; font-size: 18px; }
    .feedback.info{background:#dbeafe;color:#1e40af}.feedback.success{background:#d1fae5;color:#065f46}.feedback.error{background:#fee2e2;color:#b91c1c}.feedback.warning{background:#fef3c7;color:#92400e}
    .spinner{width:22px;height:22px;border:2px solid transparent;border-top:2px solid currentColor;border-radius:50%;animation:spin 1s linear infinite;display:inline-block}
    @keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
    @media (max-width:1000px){.card{border-right:none;border-bottom:1px solid #e5e7eb}.card:last-child{border-bottom:none}}
    @media (max-width:600px){body{font-size:16px;padding:10px}header{padding:24px}h1{font-size:28px}.subtitle{font-size:18px}.wallet-info{flex-direction:column;align-items:center;gap:15px}.card{padding:30px}.card-title{font-size:22px}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Child Account</h1>
      <div class="subtitle">Simple and secure sub-account management</div>
      <div class="wallet-info">
        <div class="status"><span>Connected: <span id="addr">-</span></span></div>
        <div class="status"><span>Network: <span id="net">-</span></span></div>
        <button id="btnConnect"><i class="fas fa-plug"></i> Connect Wallet</button>
      </div>
    </header>

    <div class="main-content">

      <!-- Pay -->
      <div class="card">
        <div class="card-title"><i class="fas fa-store"></i><span>Pay Merchant</span></div>
        <div class="form-group">
          <label for="merchant">Merchant Address</label>
          <input type="text" id="merchant" placeholder="Enter merchant address (0x...)">
        </div>
        <div class="form-group">
          <label for="amount">Amount in ETH</label>
          <input type="text" id="amount" placeholder="Enter amount (e.g. 0.01)">
        </div>
        <button class="action" onclick="pay()"><i class="fas fa-paper-plane"></i> Pay Merchant</button>
        <div class="feedback" id="payFeedback"></div>
      </div>

      <!-- Request temp -->
      <div class="card">
        <div class="card-title"><i class="fas fa-clock"></i><span>Request Limit</span></div>
        <div class="form-group">
          <label for="temp">Requested Amount in ETH</label>
          <input type="text" id="temp" placeholder="Enter amount (e.g. 0.5)">
        </div>
        <button class="action" onclick="requestTempLimit()"><i class="fas fa-plus-circle"></i> Request Limit Increase</button>
        <div class="feedback" id="tempLimitFeedback"></div>
      </div>

      <!-- Check spending -->
      <div class="card">
        <div class="card-title"><i class="fas fa-chart-line"></i><span>Check Spending</span></div>

        <!-- ▼ New: display limits and today's spending -->
        <div id="limitsBox" style="margin-bottom:14px;display:none">
          <div>Per-Tx: <span id="perTxShow">-</span> ETH</div>
          <div>Daily: <span id="dailyShow">-</span> ETH</div>
          <div>Today Spent: <span id="spentShow">-</span> ETH</div>
          <div>Remaining Today: <span id="remainShow">-</span> ETH</div>
        </div>
        <!-- ▲ End of new section -->

        <p style="margin-bottom: 25px; color: var(--gray); font-size: 18px;">
          Check your daily spending amount and remaining limit.
        </p>
        <button class="action" onclick="check()"><i class="fas fa-search"></i> Query Daily Spent</button>
        <div id="result" class="feedback"></div>
      </div>
      <!-- Savings Account -->
<div class="card">
  <div class="card-title">
    <i class="fas fa-piggy-bank"></i>
    <span>Savings Account</span>
  </div>

  <p style="margin-bottom: 25px; color: var(--gray); font-size: 18px;">
    Go to the savings page to deposit for child, release funds early, or let child withdraw after unlock time.
  </p>

  <button class="action" onclick="window.location.href='../savings/index.html'">
    <i class="fas fa-external-link-alt"></i> Open Savings Page
  </button>

  <div class="feedback info" style="display:block; margin-top:15px;">
    Tip: make sure contracts are deployed and
    <code>contracts_address.json</code> contains <b>SavingsVault</b>.
  </div>
</div>

    </div>
  </div>

</body>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<script src="./eth.js"></script>
</html>
